<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create News Article - PCU-DASMA Connect</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#1E40AF",
              secondary: "#3B82F6",
              accent: "#F59E0B",
            },
          },
        },
      };
    </script>
  </head>
  <body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16">
          <div class="flex items-center">
            <a href="../index.html" class="text-xl font-bold text-primary">PCU-DASMA Connect</a>
            <div class="hidden md:ml-10 md:flex md:space-x-8">
              <a href="dashboard.html" class="text-gray-700 hover:text-primary px-1 pt-1 pb-4 text-sm font-medium">Dashboard</a>
              <a href="events.html" class="text-gray-700 hover:text-primary px-1 pt-1 pb-4 text-sm font-medium">Events</a>
              <a href="news.html" class="text-primary border-b-2 border-primary px-1 pt-1 pb-4 text-sm font-medium">News</a>
            </div>
          </div>
          <div class="flex items-center space-x-4">
            <div class="relative">
              <button onclick="toggleUserMenu()" class="flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-primary">
                <img class="h-8 w-8 rounded-full" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23374151' viewBox='0 0 24 24'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E" alt="Profile" />
              </button>
              <div id="userMenu" class="hidden origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5">
                <div class="py-1">
                  <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Staff Profile</a>
                  <a href="#" onclick="logout()" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Logout</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-5xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
      <!-- Header -->
      <div class="flex items-center justify-between mb-8">
        <div class="flex items-center">
          <a href="news.html" class="text-gray-400 hover:text-gray-600 mr-4">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
          </a>
          <div>
            <h1 class="text-3xl font-bold text-gray-900">Create News Article</h1>
            <p class="text-gray-600">Compose and submit news articles for admin review</p>
          </div>
        </div>
        <div class="flex items-center space-x-3">
          <button onclick="previewArticle()" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">Preview</button>
        </div>
      </div>

      <!-- Article Form -->
      <form onsubmit="handleSubmitArticle(event)" class="space-y-8">
        <div class="bg-white rounded-lg shadow-sm p-6">
          <div class="space-y-6">
            <!-- Title and Basic Info -->
            <div class="grid grid-cols-1 gap-6">
              <div>
                <label for="newsTitle" class="block text-sm font-medium text-gray-700 mb-1">Article Title *</label>
                <input type="text" id="newsTitle" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-primary focus:border-primary text-lg" placeholder="Enter your article title..." />
                <p class="text-sm text-gray-500 mt-1">Keep it concise and engaging (recommended: under 100 characters)</p>
              </div>
            </div>

            <!-- Category, Author, and Dates Row -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label for="newsCategory" class="block text-sm font-medium text-gray-700 mb-1">Category *</label>
                <select id="newsCategory" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-primary focus:border-primary">
                  <option value="">Select Category</option>
                  <option value="university">University Update</option>
                  <option value="alumni">Alumni Success</option>
                  <option value="event">Event News</option>
                  <option value="partnership">Partnership Success</option>
                  <option value="general">General News</option>
                </select>
              </div>
              <div>
                <label for="newsAuthor" class="block text-sm font-medium text-gray-700 mb-1">Author</label>
                <input type="text" id="newsAuthor" value="Communications Staff" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-primary focus:border-primary" />
              </div>
              <div>
                <label for="eventDate" class="block text-sm font-medium text-gray-700 mb-1">Event Date *</label>
                <input type="date" id="eventDate" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-primary focus:border-primary" />
                <p class="text-sm text-gray-500 mt-1">Date the event took place or will take place</p>
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label for="publishDate" class="block text-sm font-medium text-gray-700 mb-1">Publish Date</label>
                <input type="date" id="publishDate" readonly class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed" />
                <p class="text-sm text-gray-500 mt-1">Set by admin upon approval</p>
              </div>
              <div>
                <label for="partnershipWith" class="block text-sm font-medium text-gray-700 mb-1">Partnership With</label>
                <input type="text" id="partnershipWith" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-primary focus:border-primary" placeholder="e.g., Clean Seas Alliance, Local Barangay" />
                <p class="text-sm text-gray-500 mt-1">Specify partner organizations or individuals</p>
              </div>
            </div>

            <!-- Summary -->
            <div>
              <label for="newsSummary" class="block text-sm font-medium text-gray-700 mb-1">Article Summary *</label>
              <textarea id="newsSummary" rows="3" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-primary focus:border-primary" placeholder="Brief summary that will appear in the article preview and social media shares..."></textarea>
              <p class="text-sm text-gray-500 mt-1">This summary will be used for previews and social media sharing (recommended: 150-200 characters)</p>
            </div>

            <!-- Featured Image Upload -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Featured Image</label>
              <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md hover:border-gray-400">
                <div class="space-y-1 text-center">
                  <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                    <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                  <div class="flex text-sm text-gray-600">
                    <label for="featuredImage" class="relative cursor-pointer bg-white rounded-md font-medium text-primary hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary">
                      <span>Upload a file</span>
                      <input id="featuredImage" name="featuredImage" type="file" accept="image/*" class="sr-only" onchange="handleImageUpload(event)" />
                    </label>
                    <p class="pl-1">or drag and drop</p>
                  </div>
                  <p class="text-xs text-gray-500">PNG, JPG, GIF up to 10MB</p>
                </div>
              </div>
              <div id="imagePreview" class="hidden mt-4">
                <img id="previewImg" class="h-48 w-full object-cover rounded-md" />
              </div>
            </div>
          </div>
        </div>

        <!-- Content Editor -->
        <div class="bg-white rounded-lg shadow-sm p-6">
          <h2 class="text-lg font-semibold text-gray-900 mb-4">Article Content</h2>
          
          <!-- Editor Toolbar -->
          <div class="border border-gray-300 rounded-t-md p-2 bg-gray-50">
            <div class="flex items-center space-x-1">
              <button type="button" onclick="formatText('bold')" class="p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-200 rounded" title="Bold">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M6 4v12h4.5a3.5 3.5 0 001.409-6.706A3 3 0 0010.5 4H6zM8 6h2.5a1 1 0 110 2H8V6zm0 4h3.5a1.5 1.5 0 110 3H8v-3z"></path>
                </svg>
              </button>
              <button type="button" onclick="formatText('italic')" class="p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-200 rounded" title="Italic">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M8.5 4a.5.5 0 01.5.5V6h2a.5.5 0 010 1h-.5l-1.5 6H11a.5.5 0 010 1H9a.5.5 0 01-.5-.5V12H6a.5.5 0 010-1h.5l1.5-6H6a.5.5 0 010-1h2V4.5a.5.5 0 01.5-.5z"></path>
                </svg>
              </button>
              <div class="w-px h-6 bg-gray-300"></div>
              <button type="button" onclick="insertHeading()" class="p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-200 rounded" title="Heading">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M3 4a1 1 0 011-1h2a1 1 0 011 1v4h6V4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1v-4H7v4a1 1 0 01-1 1H4a1 1 0 01-1-1V4z"></path>
                </svg>
              </button>
              <button type="button" onclick="insertList()" class="p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-200 rounded" title="Bullet List">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M3 4a1 1 0 000 2h14a1 1 0 100-2H3zM3 8a1 1 0 000 2h14a1 1 0 100-2H3zM3 12a1 1 0 100 2h14a1 1 0 100-2H3z"></path>
                </svg>
              </button>
              <button type="button" onclick="insertQuote()" class="p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-200 rounded" title="Quote">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M8 8a3 3 0 100-6 3 3 0 000 6zm2-3a2 2 0 11-4 0 2 2 0 014 0zm4 8a5 5 0 11-10 0h10z"></path>
                </svg>
              </button>
            </div>
          </div>

          <!-- Content Textarea -->
          <textarea id="newsContent" rows="12" required class="w-full px-3 py-3 border-l border-r border-b border-gray-300 rounded-b-md focus:outline-none focus:ring-primary focus:border-primary resize-none" placeholder="Write your full article content here...

For event news, include:
• Event purpose and significance
• Key participants and speakers
• Highlights and outcomes
• Student/community involvement
• Photos and quotes
• Upcoming related activities

For partnership success, include:
• Partnership overview and objectives
• Key achievements and metrics
• Community impact and feedback
• Photos and testimonials
• Collaboration details
• Future implications or next steps"></textarea>
          
          <div class="mt-2 flex justify-between text-sm text-gray-500">
            <span>Use the toolbar above to format your content</span>
            <span id="wordCount">0 words</span>
          </div>
        </div>

        <!-- Additional Options -->
        <div class="bg-white rounded-lg shadow-sm p-6">
          <h2 class="text-lg font-semibold text-gray-900 mb-4">Additional Options</h2>
          
          <div class="space-y-4">
            <!-- Tags -->
            <div>
              <label for="newsTags" class="block text-sm font-medium text-gray-700 mb-1">Tags *</label>
              <input type="text" id="newsTags" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-primary focus:border-primary" placeholder="e.g., university, event, community, partnership (separate with commas)" />
              <p class="text-sm text-gray-500 mt-1">Tags help categorize and make your article discoverable</p>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-between items-center">
          <a href="news.html" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">Cancel</a>
          <div class="space-x-3">
            <button type="submit" name="action" value="submit" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-blue-700">Submit for Review</button>
          </div>
        </div>
      </form>
    </div>

    <!-- Preview Modal -->
    <div id="previewModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white rounded-lg shadow-lg max-w-3xl w-full mx-4 max-h-[80vh] overflow-y-auto">
        <div class="p-6">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-900">Article Preview</h2>
            <button onclick="closePreviewModal()" class="text-gray-500 hover:text-gray-700">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          <div id="previewContent" class="space-y-4">
            <div>
              <h3 class="text-lg font-semibold text-gray-900">Title</h3>
              <p id="previewTitle" class="text-gray-700"></p>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-gray-900">Category</h3>
              <p id="previewCategory" class="text-gray-700"></p>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-gray-900">Summary</h3>
              <p id="previewSummary" class="text-gray-700"></p>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-gray-900">Content</h3>
              <div id="previewContentBody" class="text-gray-700 prose"></div>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-gray-900">Tags</h3>
              <p id="previewTags" class="text-gray-700"></p>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-gray-900">Partnership With</h3>
              <p id="previewPartnership" class="text-gray-700"></p>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-gray-900">Event Date</h3>
              <p id="previewEventDate" class="text-gray-700"></p>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-gray-900">Featured Image</h3>
              <div id="previewImageContainer" class="mt-2">
                <img id="previewModalImg" class="h-48 w-full object-cover rounded-md" />
              </div>
            </div>
          </div>
          <div class="mt-6 flex justify-end space-x-3">
            <button onclick="closePreviewModal()" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">Close</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      function toggleUserMenu() {
        const menu = document.getElementById("userMenu");
        menu.classList.toggle("hidden");
      }

      function logout() {
        if (confirm("Are you sure you want to logout?")) {
          window.location.href = "../login.html";
        }
      }

      function handleImageUpload(event) {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(e) {
            const preview = document.getElementById("imagePreview");
            const img = document.getElementById("previewImg");
            img.src = e.target.result;
            preview.classList.remove("hidden");
          };
          reader.readAsDataURL(file);
        }
      }

      function formatText(command) {
        const textarea = document.getElementById("newsContent");
        const start = textarea.selectionStart;
        const end = textarea.selectionEnd;
        const selectedText = textarea.value.substring(start, end);
        let replacement = selectedText;

        switch(command) {
          case 'bold':
            replacement = `**${selectedText}**`;
            break;
          case 'italic':
            replacement = `*${selectedText}*`;
            break;
        }

        textarea.setRangeText(replacement, start, end);
        textarea.focus();
        textarea.setSelectionRange(start + replacement.length, start + replacement.length);
      }

      function insertHeading() {
        const textarea = document.getElementById("newsContent");
        const start = textarea.selectionStart;
        textarea.setRangeText("## Heading\n\n", start, start);
        textarea.focus();
        textarea.setSelectionRange(start + 3, start + 10);
      }

      function insertList() {
        const textarea = document.getElementById("newsContent");
        const start = textarea.selectionStart;
        const listText = "• Item 1\n• Item 2\n• Item 3\n\n";
        textarea.setRangeText(listText, start, start);
        textarea.focus();
        textarea.setSelectionRange(start + 2, start + 8);
      }

      function insertQuote() {
        const textarea = document.getElementById("newsContent");
        const start = textarea.selectionStart;
        textarea.setRangeText("> Quote text\n\n", start, start);
        textarea.focus();
        textarea.setSelectionRange(start + 2, start + 12);
      }

      function updateWordCount() {
        const content = document.getElementById("newsContent").value;
        const words = content.trim().split(/\s+/).filter(word => word.length > 0).length;
        document.getElementById("wordCount").textContent = `${words} words`;
      }

      function previewArticle() {
        const title = document.getElementById("newsTitle").value;
        const category = document.getElementById("newsCategory").options[document.getElementById("newsCategory").selectedIndex].text;
        const summary = document.getElementById("newsSummary").value;
        const content = document.getElementById("newsContent").value;
        const tags = document.getElementById("newsTags").value;
        const partnership = document.getElementById("partnershipWith").value;
        const eventDate = document.getElementById("eventDate").value;

        if (!title.trim() || !category || !summary.trim() || !content.trim() || !tags.trim() || !eventDate) {
          alert("Please fill in all required fields (Title, Category, Summary, Content, Tags, Event Date) to preview the article.");
          return;
        }

        document.getElementById("previewTitle").textContent = title;
        document.getElementById("previewCategory").textContent = category;
        document.getElementById("previewSummary").textContent = summary;
        document.getElementById("previewContentBody").innerHTML = content.replace(/\n/g, "<br>").replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>").replace(/\*(.*?)\*/g, "<em>$1</em>").replace(/^## (.*)$/gm, "<h2>$1</h2>").replace(/^• (.*)$/gm, "<li>$1</li>").replace(/^> (.*)$/gm, "<blockquote>$1</blockquote>");
        document.getElementById("previewTags").textContent = tags || "None";
        document.getElementById("previewPartnership").textContent = partnership || "None";
        document.getElementById("previewEventDate").textContent = eventDate;

        const previewImg = document.getElementById("previewModalImg");
        const formImg = document.getElementById("previewImg");
        const previewImgContainer = document.getElementById("previewImageContainer");
        if (formImg.src && !formImg.src.includes("data:image/svg+xml")) {
          previewImg.src = formImg.src;
          previewImgContainer.classList.remove("hidden");
        } else {
          previewImgContainer.classList.add("hidden");
        }

        document.getElementById("previewModal").classList.remove("hidden");
      }

      function closePreviewModal() {
        document.getElementById("previewModal").classList.add("hidden");
      }

      function handleSubmitArticle(e) {
        e.preventDefault();
        const title = document.getElementById("newsTitle").value;
        const tags = document.getElementById("newsTags").value;
        const category = document.getElementById("newsCategory").value;
        const summary = document.getElementById("newsSummary").value;
        const content = document.getElementById("newsContent").value;
        const eventDate = document.getElementById("eventDate").value;
        
        if (!title.trim() || !category || !summary.trim() || !content.trim() || !tags.trim() || !eventDate) {
          alert("Please fill in all required fields (Title, Category, Summary, Content, Tags, Event Date).");
          return;
        }

        if (confirm("Submit this article for admin review?")) {
          alert(`Article "${title}" submitted for review successfully!`);
          window.location.href = "news.html";
        }
      }

      // Auto-update word count
      document.getElementById("newsContent").addEventListener("input", updateWordCount);

      // Check for edit parameter
      window.addEventListener('DOMContentLoaded', function() {
        const urlParams = new URLSearchParams(window.location.search);
        const editId = urlParams.get('edit');
        if (editId) {
          // Load existing article data for editing
          console.log(`Loading article ${editId} for editing...`);
        }
      });

      // Close user menu when clicking outside
      document.addEventListener("click", function (event) {
        const userMenu = document.getElementById("userMenu");
        const button = event.target.closest('button[onclick="toggleUserMenu()"]');

        if (!button && !userMenu.contains(event.target)) {
          userMenu.classList.add("hidden");
        }
      });
    </script>
  </body>
</html>